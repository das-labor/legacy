
#define SCROLLTEXT_C

#include "config.h"
#include "scrolltext.h"
#include "borg_hw.h"
#include "pixel.h"

extern void wait(int);


charmap pix_L = {4,{0x00,0x08,0x08,0x08,0x08,0x08,0x08,0x0F}};
charmap pix_A = {5,{0x00,0x0E,0x11,0x11,0x11,0x1F,0x11,0x11}};
charmap pix_B = {4,{0x00,0x0E,0x09,0x09,0x0E,0x09,0x09,0x0E}};
charmap pix_O = {5,{0x00,0x0E,0x11,0x11,0x11,0x11,0x11,0x0E}};
charmap pix_R = {5,{0x00,0x1C,0x12,0x12,0x1C,0x14,0x12,0x11}};
charmap pix_G = {5,{0x00,0x0E,0x11,0x10,0x17,0x11,0x11,0x0E}};

charmap pix__ = {4,{0x00,0x00,0x00,0x00,0x0F,0x00,0x00,0x00}};
charmap pix_W = {7,{0x00,0x41,0x41,0x49,0x49,0x55,0x22,0x22}};
charmap pix_I = {1,{0x00,0x01,0x01,0x01,0x01,0x01,0x01,0x01}};
charmap pix_D = {4,{0x00,0x0E,0x09,0x09,0x09,0x09,0x09,0x0E}};
charmap pix_E = {4,{0x00,0x0F,0x08,0x08,0x0F,0x08,0x08,0x0F}};
charmap pix_S = {4,{0x00,0x07,0x08,0x08,0x06,0x01,0x01,0x0E}};
charmap pix_T = {5,{0x00,0x1F,0x04,0x04,0x04,0x04,0x04,0x04}};
charmap pix_N = {5,{0x00,0x19,0x19,0x15,0x15,0x15,0x13,0x13}};
charmap pix_Z = {5,{0x00,0x1F,0x01,0x02,0x04,0x08,0x10,0x1F}};
charmap pix_C = {5,{0x00,0x0E,0x11,0x10,0x10,0x10,0x11,0x0E}};
charmap pix_K = {5,{0x00,0x11,0x12,0x14,0x18,0x14,0x12,0x11}};


/*
charmap pix_D = {5,{0x00,0x0E,0x11,0x10,0x17,0x11,0x11,0x0E}};
charmap pix_G = {5,{0x00,0x0E,0x11,0x10,0x17,0x11,0x11,0x0E}};
charmap pix_G = {5,{0x00,0x0E,0x11,0x10,0x17,0x11,0x11,0x0E}};
charmap pix_G = {5,{0x00,0x0E,0x11,0x10,0x17,0x11,0x11,0x0E}};
charmap pix_G = {5,{0x00,0x0E,0x11,0x10,0x17,0x11,0x11,0x0E}};
charmap pix_G = {5,{0x00,0x0E,0x11,0x10,0x17,0x11,0x11,0x0E}};
charmap pix_G = {5,{0x00,0x0E,0x11,0x10,0x17,0x11,0x11,0x0E}};
charmap pix_G = {5,{0x00,0x0E,0x11,0x10,0x17,0x11,0x11,0x0E}};
*/


void shift_in(charmap * cm, unsigned int delay){
	unsigned char i, y, ror;
	ror = shl_table[cm->len-1];
	for(i=0;i<cm->len;i++){
		shift_pixmap_l();
		for(y=0;y<7;y++){
			setpixel((pixel){NUM_COLS-1, y}, (cm->pix[y+1] & ror)?3:0 );
		}
		ror>>=1;
		wait(delay);
	}
	
	for(i=0;i<2;i++){
		shift_pixmap_l();
		wait(delay);
	}
}


void shift_out(unsigned char cols, unsigned int delay){
	unsigned char i;
	for(i=0;i<cols;i++){
		shift_pixmap_l();
		wait(delay);
	}
}

void labor_borg(){
	clear_screen(0);
	unsigned int delay = 70;

	shift_in(&pix_L, delay);
	shift_in(&pix_A, delay);
	shift_in(&pix_B, delay);
	shift_in(&pix_O, delay);
	shift_in(&pix_R, delay);

	shift_out(5,delay);

	shift_in(&pix_B, delay);
	shift_in(&pix_O, delay);
	shift_in(&pix_R, delay);
	shift_in(&pix_G, delay);

	shift_out(4,delay);

	shift_in(&pix__, delay);
	
	shift_out(4,delay);
	
	shift_in(&pix_W, delay);
	shift_in(&pix_I, delay);
	shift_in(&pix_D, delay);
	shift_in(&pix_E, delay);
	shift_in(&pix_R, delay);
	shift_in(&pix_S, delay);
	shift_in(&pix_T, delay);
	shift_in(&pix_A, delay);
	shift_in(&pix_N, delay);
	shift_in(&pix_D, delay);
	
	shift_out(5,delay);
	
	shift_in(&pix_I, delay);
	shift_in(&pix_S, delay);
	shift_in(&pix_T, delay);
	
	shift_out(5,delay);
	
	shift_in(&pix_Z, delay);
	shift_in(&pix_W, delay);
	shift_in(&pix_E, delay);
	shift_in(&pix_C, delay);
	shift_in(&pix_K, delay);
	shift_in(&pix_L, delay);
	shift_in(&pix_O, delay);
	shift_in(&pix_S, delay);
			
	shift_out(NUM_COLS+8,delay);
}

